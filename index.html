<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="A. Drobisch">
<title>Brainslug Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Brainslug Documentation</h1>
<div class="details">
<span id="author" class="author">A. Drobisch</span><br>
<span id="revnumber">version 0.22-SNAPSHOT</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_brainslug">Brainslug</a>
<ul class="sectlevel1">
<li><a href="#_features">Features</a></li>
<li><a href="#_example">Example</a></li>
<li><a href="#_download">Download</a></li>
</ul>
</li>
<li><a href="#_basics">Basics</a>
<ul class="sectlevel1">
<li><a href="#_flow_definition">Flow Definition</a>
<ul class="sectlevel2">
<li><a href="#_example_2">Example</a></li>
</ul>
</li>
<li><a href="#_execution">Execution</a>
<ul class="sectlevel2">
<li><a href="#_flow_instance">Flow Instance</a></li>
<li><a href="#_flow_token">Flow Token</a></li>
<li><a href="#_flow_execution_properties">Flow Execution Properties</a></li>
<li><a href="#_example_3">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_control_flow">Control Flow</a>
<ul class="sectlevel1">
<li><a href="#_brainslug_flow_node_types">Brainslug Flow Node Types</a>
<ul class="sectlevel2">
<li><a href="#_task_node">Task Node</a></li>
<li><a href="#_event_node">Event Node</a></li>
<li><a href="#_choice_node">Choice Node</a></li>
<li><a href="#_merge_node">Merge Node</a></li>
<li><a href="#_parallel_node">Parallel Node</a></li>
<li><a href="#_join_node">Join Node</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_tasks">Tasks</a>
<ul class="sectlevel1">
<li><a href="#_registry">Registry</a></li>
<li><a href="#_ways_to_define_a_task">Ways to define a task</a>
<ul class="sectlevel2">
<li><a href="#_inline_task">Inline Task</a></li>
<li><a href="#_delegate_class">Delegate class</a></li>
<li><a href="#_service_call">Service Call</a></li>
<li><a href="#_typesafe_service_call">Typesafe Service Call</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_jpa_support">JPA Support</a>
<ul class="sectlevel1">
<li><a href="#_setup">Setup</a>
<ul class="sectlevel2">
<li><a href="#_using_spring">Using Spring</a></li>
<li><a href="#_using_existing_entitymanager">Using existing EntityManager</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_spring_support">Spring Support</a>
<ul class="sectlevel1">
<li><a href="#_setup_2">Setup</a></li>
<li><a href="#_custom_brainslugcontext">Custom BrainslugContext</a></li>
</ul>
</li>
<li><a href="#_bpmn_support">BPMN Support</a>
<ul class="sectlevel1">
<li><a href="#_bpmn_renderer">BPMN Renderer</a></li>
<li><a href="#_bpmn_xml_export">BPMN XML Export</a></li>
</ul>
</li>
<li><a href="#_motivation">Motivation</a>
<ul class="sectlevel1">
<li><a href="#_design_goals">Design Goals</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="_brainslug" class="sect0">Brainslug</h1>
<div class="openblock partintro">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="images/brainslug_big.png" alt="Brainslug">
</div>
</div>
<div class="paragraph">
<p>brainslug is a control flow abstraction library.
It allows to model business logic flow of an application as a graph of typed nodes,
which can be transformed to different representations or be executed within a customisable environment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_features">Features</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Builder DSL for flow definitions</p>
</li>
<li>
<p><a href="http://www.omg.org/spec/BPMN/2.0/">BPMN 2.0 XML</a> export using the <a href="https://github.com/Activiti/Activiti">Activiti</a> Model</p>
</li>
<li>
<p>Flow Renderer based on the BPMN symbols</p>
</li>
<li>
<p>Quartz Scheduler for Async Tasks</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example">Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowBuilder simpleFlow = <span class="keyword">new</span> FlowBuilder() {
  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">simpleFlow</span><span class="delimiter">&quot;</span></span>));

    start(event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>)))
      .execute(task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">A Task</span><span class="delimiter">&quot;</span></span>))
      .execute(task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">task2</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Another Task</span><span class="delimiter">&quot;</span></span>))
        .end(event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>)));
  }
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>represents the the following flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/task_flow.png" alt="task_flow">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_download">Download</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The current version is available in the <a href="http://search.maven.org/#search%7Cga%7C1%7Cbrainslug">maven central repository</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
...
  <span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.drobisch<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>brainslug-core<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>...<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
...
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<h1 id="_basics" class="sect0">Basics</h1>
<div class="sect1">
<h2 id="_flow_definition">Flow Definition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The flow definition is the central concept of brainslug.
A definition defines possible paths / sequence of actions for a desired outcome, e.g.
the steps for an ordering process, call to external systems etc. &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>A flow definition is constructed using the <code>FlowBuilder</code> DSL and is internally represented as a directed graph of typed flow nodes.</p>
</div>
<div class="sect2">
<h3 id="_example_2">Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">HelloWorldFlow</span> <span class="directive">extends</span> FlowBuilder {

  <span class="directive">public</span> <span class="directive">static</span> Identifier helloFlow = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">helloFlow</span><span class="delimiter">&quot;</span></span>);

  <span class="directive">public</span> <span class="directive">static</span> Identifier start = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>);
  <span class="directive">public</span> <span class="directive">static</span> Identifier helloTask = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">helloTask</span><span class="delimiter">&quot;</span></span>);

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(helloFlow);

    start(start).execute(task(helloTask, <span class="keyword">new</span> SimpleTask() {
      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="type">void</span> execute(ExecutionContext context) {
        <span class="predefined-type">System</span>.out.println(<span class="predefined-type">String</span>.format(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello %s!</span><span class="delimiter">&quot;</span></span>, context.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class))
        );
      }
    }));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>brainslug provides a set of predefined node types to define the <a href="http://control-flow">control flow</a>.
These types might be extended in additional modules like the <a href="https://github.com/adrobisch/brainslug/blob/master/bpmn">BPMN</a>
support.</p>
</div>
<div class="paragraph">
<p>In addition to the examples here in the documentation,
the <a href="https://github.com/adrobisch/brainslug/blob/master/model/src/test/java/brainslug/flow/builder/FlowBuilderTest.java">FlowBuilderTest</a>
is a good source for examples on how to build flow definitions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_execution">Execution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To execute a flow definition you need to create <code>BrainslugContext</code> which defines all aspects of the execution.
The <code>DefaultBrainslugContext</code> will use <code>HashMap</code> and <code>List</code>-based implementations for all aspects related to storing flow instance information.
It is possible to add durable persistence by using the <a href="http://jpa-support">JPA</a>-module or by writing custom stores.</p>
</div>
<div class="sect2">
<h3 id="_flow_instance">Flow Instance</h3>
<div class="paragraph">
<p>A flow instance is a single execution of a flow definition. A flow instance may have properties
which are stored in the <code>PropertyStore</code> to share data between flow nodes while the execution is not completed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_flow_token">Flow Token</h3>
<div class="paragraph">
<p>A flow token is a pointer to a flow node in a flow instance. A flow node might have multiple tokens.</p>
</div>
<div class="paragraph">
<p>Tokens are consumed / deleted when the execution of a single node was successfully, which in turn creates
new tokens in the nodes which are considered as the next tokens in the flow or path of execution.</p>
</div>
<div class="paragraph">
<p>Which succeeding nodes get tokens is decided by the corresponding <code>FlowNodeExecutor</code> of the node.
The token includes the information which node execution lead to the creation of token (<strong>"where it came from"</strong>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_flow_execution_properties">Flow Execution Properties</h3>
<div class="paragraph">
<p>Execution Properties are key-value pairs which can be seen as the input parameters for an flow instance.
They are used to influence the execution of an instance by changing the control flow
or by acting as input for the execution of tasks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_3">Example</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">//  create brainslug context with defaults</span>
BrainslugContext context = <span class="keyword">new</span> BrainslugContextBuilder().build();
<span class="comment">// add the flow definition</span>
FlowDefinition helloFlow = <span class="keyword">new</span> HelloWorldFlow().getDefinition();
context.addFlowDefinition(helloFlow);
<span class="comment">// start the flow with property 'name' = &quot;World&quot;</span>
context.startFlow(helloFlow, newProperties().with(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">World</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>will execute the <code>helloFlow</code> from the listing above and thus print <code>Hello World!</code> on the console.</p>
</div>
</div>
</div>
</div>
<h1 id="_control_flow" class="sect0">Control Flow</h1>
<div class="sect1">
<h2 id="_brainslug_flow_node_types">Brainslug Flow Node Types</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_task_node">Task Node</h3>
<div class="paragraph">
<p>A Task Node will be executed for every incoming token and produces one token per outgoing edge. See the [task documentation](task)
for details on how to define what a task should do during execution.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/single_task.png" alt="single_task">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_event_node">Event Node</h3>
<div class="paragraph">
<p>An Event Node is triggered by every incoming token and produces one token per outgoing edge.
There are different type of event: Start Events, End Events, Wait (Intermediate) Events.</p>
</div>
<div class="sect3">
<h4 id="_example_4">Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">EventFlow</span> <span class="directive">extends</span> FlowBuilder {

  Identifier eventFlowId = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">helloFlow</span><span class="delimiter">&quot;</span></span>);

  EventDefinition eventFlowStart = event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Every 5 Seconds</span><span class="delimiter">&quot;</span></span>);

  EventDefinition fiveSecondsPassed = event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">wait</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">After 5 Seconds</span><span class="delimiter">&quot;</span></span>)
    .timePassed(<span class="integer">5</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);

  TaskDefinition theTask = task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">doIt</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Do Something</span><span class="delimiter">&quot;</span></span>);

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(eventFlowId);

    start(eventFlowStart, every(<span class="integer">5</span>, <span class="predefined-type">TimeUnit</span>.SECONDS))
      .waitFor(fiveSecondsPassed)
      .execute(theTask);
  }
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/event_flow.png" alt="event_flow">
</div>
</div>
<div class="paragraph">
<p>Start Events mark the start of a flow and are generally the starting point of your flow definition.
The <code>waitFor</code>-method takes an event definition which might have duration to wait for and create a intermediate event
for it.</p>
</div>
<div class="paragraph">
<p>End Events mark the end of a flow execution path and are optional.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_choice_node">Choice Node</h3>
<div class="paragraph">
<p>A Choice Node will be executed for every incoming token. A token is produced for the first outgoing path
where the predicate is fullfilled.</p>
</div>
</div>
<div class="sect2">
<h3 id="_merge_node">Merge Node</h3>
<div class="paragraph">
<p>A Merge Node merges different execution paths. It will be executed for every incoming token. A token is produced for every outgoing edge.</p>
</div>
<div class="sect3">
<h4 id="_example_5">Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">ChoiceFlow</span> <span class="directive">extends</span> FlowBuilder {

  Identifier choiceFlowId = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">choiceFlow</span><span class="delimiter">&quot;</span></span>);

  EventDefinition choiceFlowStart = event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>));
  EventDefinition choiceEnd = event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>);

  Identifier meaningOfLiveChoice = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">meaning_choice</span><span class="delimiter">&quot;</span></span>);
  Value meaningProperty = property(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">meaning</span><span class="delimiter">&quot;</span></span>));

  EqualsExpression equalsFortyTwo = eq(meaningProperty, <span class="integer">42</span>);
  EqualsExpression equalsFortyThree = eq(meaningProperty, <span class="integer">43</span>);

  TaskDefinition meaningfulTask = task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">meaning_ful</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Meaningful Task</span><span class="delimiter">&quot;</span></span>);
  TaskDefinition meaninglessTask = task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">meaning_less</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Meaningless Task</span><span class="delimiter">&quot;</span></span>);

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(choiceFlowId);

    start(choiceFlowStart)
      .choice(meaningOfLiveChoice).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Meaning of live?</span><span class="delimiter">&quot;</span></span>)
        .when(equalsFortyTwo)
          .execute(meaningfulTask)
        .or()
        .when(equalsFortyThree)
          .execute(meaninglessTask);

    merge(meaningfulTask, meaninglessTask)
      .end(choiceEnd);
  }
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/choice_flow.png" alt="choice_flow">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parallel_node">Parallel Node</h3>
<div class="paragraph">
<p>A Parallel Node defines flow paths which are meant for parallel execution, if the execution is really concurrent depends on the
configuration of the corresponding <code>FlowNodeExecutor</code>. It will be executed for every incoming token. A token is produced for every outgoing edge.</p>
</div>
</div>
<div class="sect2">
<h3 id="_join_node">Join Node</h3>
<div class="paragraph">
<p>A Parallel Node joins or synchronizes multiple concurrent execution paths. It will only be executed if it has tokens from every incoming edge.
A token is produced for every outgoing edge.</p>
</div>
<div class="sect3">
<h4 id="_example_6">Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">ParallelFlow</span> <span class="directive">extends</span> FlowBuilder {

  Identifier parallelFlowId = id(<span class="string"><span class="delimiter">&quot;</span><span class="content">parallel_flow</span><span class="delimiter">&quot;</span></span>);

  EventDefinition flowStart = event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>));
  EventDefinition flowEnd = event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>);

  TaskDefinition firstTask = task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">first_task</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Do Something</span><span class="delimiter">&quot;</span></span>);
  TaskDefinition secondTask = task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">second_task</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Do another Thing</span><span class="delimiter">&quot;</span></span>);

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(parallelFlowId);

    start(flowStart)
      .parallel(id())
        .execute(firstTask)
          .and()
        .execute(secondTask);

    join(firstTask, secondTask)
      .end(flowEnd);
  }
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/parallel_flow.png" alt="parallel_flow">
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="_tasks" class="sect0">Tasks</h1>
<div class="sect1">
<h2 id="_registry">Registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The brainslug context has a <code>Registry</code> where singletons of service classes can be registered:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">context.getRegistry().registerService(Delegate.class, <span class="keyword">new</span> Delegate());</code></pre>
</div>
</div>
<div class="paragraph">
<p>or retrieved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Delegate delegateService = context.getRegistry().getService(Delegate.class);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ways_to_define_a_task">Ways to define a task</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_inline_task">Inline Task</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowBuilder inlineTaskFlow = <span class="keyword">new</span> FlowBuilder() {
  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">task_flow</span><span class="delimiter">&quot;</span></span>));

    start(event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Start</span><span class="delimiter">&quot;</span></span>))
      .execute(task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="delimiter">&quot;</span></span>), <span class="keyword">new</span> SimpleTask() {
        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> execute(ExecutionContext ctx) {
          ctx.service(ExampleService.class).doSomething();
        }
      }).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Do Something</span><span class="delimiter">&quot;</span></span>))
      .end(event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">End</span><span class="delimiter">&quot;</span></span>));
  }
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>Java 8</strong> the task can be defined using a lambda expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ctx -&gt; {
  ctx.service(MyService.class).doSomething();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_delegate_class">Delegate class</h3>
<div class="paragraph">
<p>If you do not want to specify the method by name, you can use the <code>Execute</code>-annotation to define which
method you want be executed for a task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">TestDelegate</span> <span class="directive">implements</span> Delegate {
  <span class="annotation">@Execute</span>
  <span class="directive">abstract</span> <span class="directive">public</span> <span class="type">void</span> execute(TestService testService, ExecutionContext context);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowDefinition handlerFlow = <span class="keyword">new</span> FlowBuilder() {
  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    start(event(id(START)))
      .execute(task(id(TASK)).delegate(TestDelegate.class))
    .end(event(id(END)));
  }
}.getDefinition();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_service_call">Service Call</h3>
<div class="paragraph">
<p>You may use service call definition, to directly define the invocation of a method during flow node definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowDefinition serviceCallFlow = <span class="keyword">new</span> FlowBuilder() {

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    start(event(id(START)))
      .execute(task(id(TASK)).call(method(TestService.class).name(<span class="string"><span class="delimiter">&quot;</span><span class="content">getString</span><span class="delimiter">&quot;</span></span>)))
    .end(event(id(END)));
  }

}.getDefinition();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_typesafe_service_call">Typesafe Service Call</h3>
<div class="paragraph">
<p>It possible to define service calls using a proxy-based approach similar to Mockito.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">TestService</span> {
  <span class="predefined-type">String</span> getString();

  <span class="predefined-type">String</span> echo(<span class="predefined-type">String</span> echo);

  <span class="predefined-type">String</span> multiEcho(<span class="predefined-type">String</span> echo, <span class="predefined-type">String</span> echo2);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowDefinition serviceCallFlow = <span class="keyword">new</span> FlowBuilder() {

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    Property&lt;<span class="predefined-type">String</span>&gt; echoProperty = FlowBuilderSupport.property(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">echo</span><span class="delimiter">&quot;</span></span>), <span class="predefined-type">String</span>.class);

    TestService testService = service(TestService.class);

    start(event(id(START)))
      .execute(task(id(TASK)).call(method(testService.echo(testService.getString()))))
      .execute(task(id(TASK2)).call(method(testService.echo(value(echoProperty)))))
    .end(event(id(END)));

  }

}.getDefinition();</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the call to the service will be made at execution using the recorded argument values.
This will be done using reflection on the instance of the service, which must be available in the <code>Registry</code>.</p>
</div>
</div>
</div>
</div>
<h1 id="_jpa_support" class="sect0">JPA Support</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>It is possible to use JPA for the persistence of flow instance information.
This support is implemented using querydsl.</p>
</div>
<div class="paragraph">
<p><strong>Tested Databases</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MySQL 5.5</p>
</li>
<li>
<p>PostgreSQL 9.5</p>
</li>
<li>
<p>H2 1.3.170</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup">Setup</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_using_spring">Using Spring</h3>
<div class="paragraph">
<p>Spring configuration classes are provided and just need to be imported.
Your application context only needs to provide <code>JPQLTemplates</code> and
an <code>EntityManager</code> with the <code>brainslug.jpa.entity</code> package entities registered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@Import</span>({SpringBrainslugConfiguration.class, SpringDatabaseConfiguration.class})
<span class="directive">public</span> <span class="type">class</span> <span class="class">BrainslugConfiguration</span> {

    <span class="annotation">@Bean</span>
    JPQLTemplates jpqlTemplates() {
      <span class="keyword">return</span> <span class="keyword">new</span> HQLTemplates();
    }

    <span class="annotation">@Bean</span>
    FlowBuilder aFlow() {
        ...
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_existing_entitymanager">Using existing EntityManager</h3>
<div class="paragraph">
<p>First you need an instance of <code>brainslug.jdbc.Database</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">new</span> Database(entityManager, <span class="keyword">new</span> HQLTemplates()); <span class="comment">// adjust templates to your JPA provider</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>to create a the JPA TokenStore, JPA PropertyStore and JPA AsyncTriggerStore</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JpaTokenStore jpaTokenStore = <span class="keyword">new</span> JpaTokenStore(...)
JpaAsyncTriggerStore jpaAsyncTriggerStore = <span class="keyword">new</span> JpaAsyncTriggerStore(...)
JpaPropertyStore jpaPropertyStore = <span class="keyword">new</span> JpaPropertyStore(...)</code></pre>
</div>
</div>
<div class="paragraph">
<p>These can than be provided to the <code>BrainslugContextBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">new</span> BrainslugContextBuilder()
  .withTokenStore(jpaTokenStore)
  .withAsyncTriggerStore(jpaAsyncTriggerStore)
  .withPropertyStore(jpaPropertyStore)
  .build()</code></pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="_spring_support" class="sect0">Spring Support</h1>
<div class="openblock partintro">
<div class="content">
It is possible integrate brainslug with the Spring application context, so that the Spring Beans
are available in the execution context.
To use it, you need to get the <a href="http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22brainslug-spring%22"><code>brainslug-spring</code> module</a>.
</div>
</div>
<div class="sect1">
<h2 id="_setup_2">Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Just import the spring configuration class into you application context.</p>
</div>
<div class="paragraph">
<p>Calls to the <code>ExecutionContext</code> or the <code>Registry</code> will then return the beans from the Spring application context.</p>
</div>
<div class="paragraph">
<p>All beans of type <code>FlowBuilder</code> will be made available in the <code>BrainslugContext</code> as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@Import</span>(brainslug.spring.SpringBrainslugConfiguration.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ConfigurationExample</span> {

  <span class="annotation">@Component</span>
  <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">SpringExampleTask</span> <span class="directive">implements</span> SimpleTask {
    Environment environment;

    <span class="annotation">@Autowired</span>
    <span class="directive">public</span> SpringExampleTask(Environment environment) {
      <span class="local-variable">this</span>.environment = environment;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> execute(ExecutionContext context) {
      printHello(context.property(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="predefined-type">String</span>.class));

      context.service(SpringExampleTask.class).printHello(<span class="string"><span class="delimiter">&quot;</span><span class="content">again</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="type">void</span> printHello(<span class="predefined-type">String</span> name) {
      <span class="predefined-type">System</span>.out.println(
        format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello %s!</span><span class="delimiter">&quot;</span></span>, name)
      );
    }
  }

  <span class="annotation">@Bean</span>
  FlowBuilder flowBuilder() {
    <span class="keyword">return</span> <span class="keyword">new</span> FlowBuilder() {
      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="type">void</span> define() {
        flowId(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">spring-flow</span><span class="delimiter">&quot;</span></span>));

        start(task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">spring-task</span><span class="delimiter">&quot;</span></span>)).delegate(SpringExampleTask.class));
      }
    };
  }

  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
    AnnotationConfigApplicationContext applicationContext =
      <span class="keyword">new</span> AnnotationConfigApplicationContext(ConfigurationExample.class);

    BrainslugContext brainslugContext = applicationContext.getBean(BrainslugContext.class);

    brainslugContext.startFlow(FlowBuilder.id(<span class="string"><span class="delimiter">&quot;</span><span class="content">spring-flow</span><span class="delimiter">&quot;</span></span>),
      newProperties().with(<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">World</span><span class="delimiter">&quot;</span></span>));
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will output the two lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">Hello World!
Hello again!</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_custom_brainslugcontext">Custom BrainslugContext</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure the <code>BrainslugContext</code> in your <code>ApplicationContext</code> you can use the <code>SpringBrainslugContextBuilder</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="annotation">@Import</span>(brainslug.spring.SpringBrainslugConfiguration.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ContextBuilderExample</span> {
  <span class="annotation">@Bean</span>
  SpringBrainslugContextBuilder contextBuilder() {
    <span class="keyword">return</span> <span class="keyword">new</span> SpringBrainslugContextBuilder()
      .withPropertyStore(<span class="keyword">new</span> HashMapPropertyStore());
      <span class="comment">// ...</span>
  }
}</code></pre>
</div>
</div>
</div>
</div>
<h1 id="_bpmn_support" class="sect0">BPMN Support</h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>brainslug is able to export flow definitions to BPMN 2.0 as rendered image or XML definitions file.</p>
</div>
<div class="paragraph">
<p>The following examples use this flow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FlowBuilder simpleFlow = <span class="keyword">new</span> FlowBuilder() {
  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> define() {
    flowId(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">simpleFlow</span><span class="delimiter">&quot;</span></span>));

    start(event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span>)))
      .execute(task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">A Task</span><span class="delimiter">&quot;</span></span>))
      .execute(task(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">task2</span><span class="delimiter">&quot;</span></span>)).display(<span class="string"><span class="delimiter">&quot;</span><span class="content">Another Task</span><span class="delimiter">&quot;</span></span>))
        .end(event(id(<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span>)));
  }
};</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bpmn_renderer">BPMN Renderer</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">Format</span> format = <span class="predefined-type">Format</span>.JPG;
JGraphBpmnRenderer renderer = <span class="keyword">new</span> JGraphBpmnRenderer(<span class="keyword">new</span> DefaultSkin());

<span class="predefined-type">String</span> fileName = simpleFlow.getName() + <span class="string"><span class="delimiter">&quot;</span><span class="content">.</span><span class="delimiter">&quot;</span></span> + format.name();
<span class="predefined-type">FileOutputStream</span> outputFile = <span class="keyword">new</span> <span class="predefined-type">FileOutputStream</span>(fileName);

renderer.render(simpleFlow, outputFile, format);</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/task_flow.png" alt="task_flow">
</div>
</div>
<div class="paragraph">
<p>also see: <a href="https://github.com/adrobisch/brainslug/blob/master/renderer/src/test/java/brainslug/flow/renderer/JGraphBpmnRendererTest.java">JGraphBpmnRendererTest</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bpmn_xml_export">BPMN XML Export</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">BpmnModelExporter bpmnModelExporter = <span class="keyword">new</span> BpmnModelExporter();
<span class="predefined-type">String</span> bpmnXml = bpmnModelExporter.toBpmnXml(simpleFlow);</code></pre>
</div>
</div>
<div class="paragraph">
<p>will produce</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;definitions</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.omg.org/spec/BPMN/20100524/MODEL</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:activiti</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://activiti.org/bpmn</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:bpmndi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.omg.org/spec/BPMN/20100524/DI</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:omgdc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.omg.org/spec/DD/20100524/DC</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:omgdi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.omg.org/spec/DD/20100524/DI</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">typeLanguage</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">expressionLanguage</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/1999/XPath</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">targetNamespace</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.activiti.org/test</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;process</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">471ff134-4050-497b-bf80-d1fa5164f311</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">471ff134-4050-497b-bf80-d1fa5164f311</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">isExecutable</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;startEvent</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/startEvent&gt;</span>
        <span class="tag">&lt;serviceTask</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">A Task</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/serviceTask&gt;</span>
        <span class="tag">&lt;serviceTask</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">task2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Another Task</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/serviceTask&gt;</span>
        <span class="tag">&lt;endEvent</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/endEvent&gt;</span>
        <span class="tag">&lt;sequenceFlow</span> <span class="attribute-name">sourceRef</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">start</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">targetRef</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/sequenceFlow&gt;</span>
        <span class="tag">&lt;sequenceFlow</span> <span class="attribute-name">sourceRef</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">task</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">targetRef</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">task2</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/sequenceFlow&gt;</span>
        <span class="tag">&lt;sequenceFlow</span> <span class="attribute-name">sourceRef</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">task2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">targetRef</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">end</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/sequenceFlow&gt;</span>
    <span class="tag">&lt;/process&gt;</span>
    <span class="tag">&lt;bpmndi:BPMNDiagram</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BPMNDiagram_471ff134-4050-497b-bf80-d1fa5164f311</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;bpmndi:BPMNPlane</span> <span class="attribute-name">bpmnElement</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">471ff134-4050-497b-bf80-d1fa5164f311</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">BPMNPlane_471ff134-4050-497b-bf80-d1fa5164f311</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="tag">&lt;/bpmndi:BPMNPlane&gt;</span>
    <span class="tag">&lt;/bpmndi:BPMNDiagram&gt;</span>
<span class="tag">&lt;/definitions&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>also see: <a href="https://github.com/adrobisch/brainslug/blob/master/bpmn/src/test/java/brainslug/bpmn/BpmnModelTransformerTest.java">BpmnModelTransformerTest</a></p>
</div>
</div>
</div>
<h1 id="_motivation" class="sect0">Motivation</h1>
<div class="openblock partintro">
<div class="content">
<div class="quoteblock">
<blockquote>
"Do we really need another Workflow-BPM-whatever engines on the JVM? Smells like <strong>'Not invented here'</strong>!"
</blockquote>
</div>
<div class="paragraph">
<p><a href="http://activiti.org">Activiti</a>, <a href="http://camunda.org">camunda BPM</a> and <a href="http://www.jbpm.org/">jBPM</a> might be the most popular on the list, but they all have some kind of bigger legacy and target environment
they have to deal with and its more difficult to just get to their core.</p>
</div>
<div class="paragraph">
<p>For example, Activiti is very focused on BPMN 2.0 and its jBPM 4 roots, jBPM5 is coming from the business rule side,
BPEL engines make most sense in WS-* environments.</p>
</div>
<div class="paragraph">
<p>To some degree they all share some strong assumptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Relational persistence (with JDBC), execution semantics are often coupled to the database transaction management</p>
</li>
<li>
<p>High initial learning effort required to learn the workflow description language like BPMN, BPEL</p>
</li>
<li>
<p>Dynamic expression evaluation, at least to control the flow</p>
</li>
<li>
<p>You are living in a container (Tomcat / Spring, Java Enterprise Edition / JBoss)</p>
</li>
<li>
<p>XML based descriptions / configurations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/brainslug_big.png" alt="brainslug_big"></span> aims to provide a <strong>small</strong> workflow library for the JVM without these strings attached.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_goals">Design Goals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A developer using brainslug should be able to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>have no external dependencies in the core parts (model and execution), except for logging</p>
</li>
<li>
<p>understand the execution model by reading the code</p>
</li>
<li>
<p>customize all aspects the library (including persistence and transaction management)</p>
</li>
<li>
<p>not want to buy commercial (sometimes called <strong>enterprise</strong>) support</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.22-SNAPSHOT<br>
Last updated 2016-04-02 13:20:07 +02:00
</div>
</div>
</body>
</html>